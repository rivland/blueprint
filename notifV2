blueprint:
  name: Dynamic Notification
  description: Sends dynamic notifications.
  domain: automation

  input:
    trigger:
      name: Trigger
      description: The event that triggers the notification.
      required: true
      selector: trigger  # Use the trigger selector

    title:
      name: Title
      description: The title of the notification.
      selector: text

    message:
      name: Message
      description: The content of the message.
      required: true
      selector: text

    target:
      name: Notification Service
      description: The notification service to use (e.g., notify.mobile_app_your_phone).
      required: true
      selector:
        entity:
          domain: notify  # Use the entity selector for notification services

    tag:
      name: Tag (optional)
      description: An identifier to group notifications.
      selector: text

    dynamic_message:
      name: Dynamic Message (optional)
      description: Dynamic message (Jinja2).
      selector: text

    dynamic_title:
      name: Dynamic Title (optional)
      description: Dynamic title (Jinja2).
      selector: text

    dynamic_icon:
      name: Dynamic Icon (optional)
      description: Dynamic icon (Jinja2).
      selector: text

  action:
    - variables:
        message_content: "{{ input.dynamic_message if input.dynamic_message else input.message }}"
        title_content: "{{ input.dynamic_title if input.dynamic_title else input.title }}"
        icon_content: "{{ input.dynamic_icon if input.dynamic_icon else '' }}"

    - service: "{{ input.target }}"
      data:
        title: "{{ title_content }}"
        message: "{{ message_content }}"
        tag: "{{ input.tag }}"
        icon: "{{ icon_content }}"
