blueprint:
  name: Notification dynamique
  description: Envoie des notifications dynamiques.
  domain: automation

  input:
    message:
      name: Message
      description: Le contenu du message.
      required: true
      selector: text

    title:
      name: Titre (optionnel)
      description: Le titre de la notification.
      selector: text

    target:
      name: Service de notification
      description: Le service de notification à utiliser (ex: notify.mobile_app_mon_telephone).
      required: true
      selector:
        entity:
          domain: notify

    tag:
      name: Tag (optionnel)
      description: Un identifiant pour regrouper les notifications.
      selector: text

    dynamic_message:
      name: Message dynamique (optionnel)
      description: Message dynamique (Jinja2).
      selector: text

    dynamic_title:
      name: Titre dynamique (optionnel)
      description: Titre dynamique (Jinja2).
      selector: text

    dynamic_icon:
      name: Icône dynamique (optionnel)
      description: Icône dynamique (Jinja2).
      selector: text

  action:
    - variables:
        message_content: "{{ input.dynamic_message if input.dynamic_message else input.message }}"
        title_content: "{{ input.dynamic_title if input.dynamic_title else input.title }}"
        icon_content: "{{ input.dynamic_icon if input.dynamic_icon else '' }}"
    - service: "{{ input.target }}"
      data:
        title: "{{ title_content }}"
        message: "{{ message_content }}"
        tag: "{{ input.tag }}"
        icon: "{{ icon_content }}"
