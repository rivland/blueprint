blueprint:
  name: Notification dynamique
  description: Envoie des notifications avec des options dynamiques.
  domain: automation

  input:
    message:
      name: Message
      description: Le contenu du message.
      required: true
      selector: text

    title:
      name: Titre (optionnel)
      description: Le titre de la notification.
      selector: text

    target:
      name: Service de notification
      description: Le service de notification à utiliser (ex: notify.mobile_app_mon_telephone).
      required: true
      selector: target

    tag:
      name: Tag (optionnel)
      description: Un identifiant pour regrouper les notifications (utile pour les remplacer ou les supprimer).
      selector: text

    dynamic_message:
      name: Message dynamique (optionnel)
      description: Un message qui sera mis à jour dynamiquement. Utilisez des templates Jinja2.
      selector: text

    dynamic_title:
      name: Titre dynamique (optionnel)
      description: Un titre qui sera mis à jour dynamiquement. Utilisez des templates Jinja2.
      selector: text

    dynamic_icon:
      name: Icône dynamique (optionnel)
      description: Une icône qui sera mise à jour dynamiquement. Utilisez des templates Jinja2 (ex: mdi:...).
      selector: text

  variables:
    message_content: "{{ input.message }}"
    title_content: "{{ input.title }}"
    icon_content: "{{ input.icon }}"

    {% if input.dynamic_message %}
      message_content: "{{ input.dynamic_message }}"
    {% endif %}

    {% if input.dynamic_title %}
      title_content: "{{ input.dynamic_title }}"
    {% endif %}

     {% if input.dynamic_icon %}
      icon_content: "{{ input.dynamic_icon }}"
    {% endif %}

  action:
    - service: "{{ input.target }}"
      data:
        message: "{{ message_content }}"
        title: "{{ title_content }}"
        data:
          tag: "{{ input.tag }}"
          icon: "{{ icon_content }}"
