blueprint:
  name: Notification Dynamique - Base
  description: "Envoie une notification personnalisée selon un déclencheur défini."
  domain: automation
  input:
    trigger_event:
      name: Déclencheur
      description: "Sélectionne un déclencheur pour envoyer la notification."
      selector:
        trigger: {}

    notif_title:
      name: Titre (optionnel)
      description: "Titre de la notification (laisser vide pour ne pas afficher)."
      default: ""
      selector:
        text: {}

    notif_message:
      name: Message
      description: "Contenu de la notification."
      selector:
        text: {}

    notify_device:
      name: Appareil(s) à notifier
      description: "Sélectionne les appareils à notifier lorsque l'automatisation se déclenche."
      default: []
      selector:
        device:
          filter:
            - integration: mobile_app
          multiple: true

mode: restart

trigger: !input trigger_event

action:
  - service: notify.mobile_app_{{ device_attr(notify_device[0], 'name') | lower | replace(' ', '_') }}
    data:
      title: "{{ iif(notif_title != '', notif_title, omit) }}"
      message: "{{ notif_message }}"
